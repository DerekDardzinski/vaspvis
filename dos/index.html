
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../band/">
      
      
        <link rel="next" href="../charge/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.4">
    
    
      
        <title>Density of States - VaspVis Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dospy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="VaspVis Documentation" class="md-header__button md-logo" aria-label="VaspVis Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            VaspVis Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Density of States
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="VaspVis Documentation" class="md-nav__button md-logo" aria-label="VaspVis Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    VaspVis Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../standard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Standardized Plots
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../band/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Band Structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Density of States
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Density of States
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dospy" class="md-nav__link">
    <span class="md-ellipsis">
      dos.py
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vaspvis.dos" class="md-nav__link">
    <span class="md-ellipsis">
      dos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos" class="md-nav__link">
    <span class="md-ellipsis">
      Dos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_atom_orbitals" class="md-nav__link">
    <span class="md-ellipsis">
      plot_atom_orbitals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_atom_spd" class="md-nav__link">
    <span class="md-ellipsis">
      plot_atom_spd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      plot_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_element_orbitals" class="md-nav__link">
    <span class="md-ellipsis">
      plot_element_orbitals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_element_spd" class="md-nav__link">
    <span class="md-ellipsis">
      plot_element_spd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_elements" class="md-nav__link">
    <span class="md-ellipsis">
      plot_elements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_layers" class="md-nav__link">
    <span class="md-ellipsis">
      plot_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_ldos" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ldos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_orbitals" class="md-nav__link">
    <span class="md-ellipsis">
      plot_orbitals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_plain" class="md-nav__link">
    <span class="md-ellipsis">
      plot_plain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_spd" class="md-nav__link">
    <span class="md-ellipsis">
      plot_spd
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../charge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Charge Transfer Plots
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    STM Images
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dospy" class="md-nav__link">
    <span class="md-ellipsis">
      dos.py
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vaspvis.dos" class="md-nav__link">
    <span class="md-ellipsis">
      dos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos" class="md-nav__link">
    <span class="md-ellipsis">
      Dos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_atom_orbitals" class="md-nav__link">
    <span class="md-ellipsis">
      plot_atom_orbitals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_atom_spd" class="md-nav__link">
    <span class="md-ellipsis">
      plot_atom_spd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      plot_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_element_orbitals" class="md-nav__link">
    <span class="md-ellipsis">
      plot_element_orbitals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_element_spd" class="md-nav__link">
    <span class="md-ellipsis">
      plot_element_spd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_elements" class="md-nav__link">
    <span class="md-ellipsis">
      plot_elements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_layers" class="md-nav__link">
    <span class="md-ellipsis">
      plot_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_ldos" class="md-nav__link">
    <span class="md-ellipsis">
      plot_ldos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_orbitals" class="md-nav__link">
    <span class="md-ellipsis">
      plot_orbitals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_plain" class="md-nav__link">
    <span class="md-ellipsis">
      plot_plain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaspvis.dos.Dos.plot_spd" class="md-nav__link">
    <span class="md-ellipsis">
      plot_spd
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Density of States</h1>

<h2 id="dospy">dos.py</h2>


<div class="doc doc-object doc-module">



<a id="vaspvis.dos"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="vaspvis.dos.Dos" class="doc doc-heading">
          <code>Dos</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>This class contains all the methods for contructing density of states plots from the outputs of VASP calculations.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This is the folder that contains the VASP files.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>spin</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Which spin direction to parse ('up' or 'down')</p>
            </div>
          </td>
          <td>
                <code>&#39;up&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>combination_method</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the spin option is 'both', the combination method can either be additive or substractive
by passing 'add' or 'sub'. It spin is passed as 'up' or 'down' this option is ignored.</p>
            </div>
          </td>
          <td>
                <code>&#39;add&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>vaspvis/dos.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  25</span>
<span class="normal">  26</span>
<span class="normal">  27</span>
<span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Dos</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class contains all the methods for contructing density of states plots from the outputs of VASP calculations.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        folder (str): This is the folder that contains the VASP files.</span>
<span class="sd">        spin (str): Which spin direction to parse (&#39;up&#39; or &#39;down&#39;)</span>
<span class="sd">        combination_method (str): If the spin option is &#39;both&#39;, the combination method can either be additive or substractive</span>
<span class="sd">            by passing &#39;add&#39; or &#39;sub&#39;. It spin is passed as &#39;up&#39; or &#39;down&#39; this option is ignored.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">folder</span><span class="p">,</span>
        <span class="n">spin</span><span class="o">=</span><span class="s2">&quot;up&quot;</span><span class="p">,</span>
        <span class="n">soc_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">combination_method</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">,</span>
        <span class="n">sp_method</span><span class="o">=</span><span class="s2">&quot;percentage&quot;</span><span class="p">,</span>
        <span class="n">shift_efermi</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="n">spin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">=</span> <span class="n">soc_axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">=</span> <span class="n">combination_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">=</span> <span class="n">sp_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">incar</span> <span class="o">=</span> <span class="n">Incar</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;INCAR&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="s2">&quot;LORBIT&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">incar</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">incar</span><span class="p">[</span><span class="s2">&quot;LORBIT&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">11</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lorbit</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lorbit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lorbit</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lorbit</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;dos.npy&quot;</span><span class="p">)</span>
            <span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;projected_dos.npy&quot;</span><span class="p">)):</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;dos.npy&quot;</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dos_file</span><span class="p">:</span>
                    <span class="n">dos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">dos_file</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;projected_dos.npy&quot;</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span>
                <span class="p">)</span> <span class="k">as</span> <span class="n">projected_dos_file</span><span class="p">:</span>
                    <span class="n">projected_dos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">projected_dos_file</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">doscar</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">dos</span><span class="p">,</span>
                    <span class="s2">&quot;projected&quot;</span><span class="p">:</span> <span class="n">projected_dos</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_f_error</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_fix_doscar</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">doscar</span> <span class="o">=</span> <span class="n">VaspDoscar</span><span class="o">.</span><span class="n">parse_doscar</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;DOSCAR&quot;</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;dos.npy&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">doscar</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">])</span>
                <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;projected_dos.npy&quot;</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">doscar</span><span class="p">[</span><span class="s2">&quot;projected&quot;</span><span class="p">],</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;dos.npy&quot;</span><span class="p">)):</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;dos.npy&quot;</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dos_file</span><span class="p">:</span>
                    <span class="n">dos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">dos_file</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">doscar</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">dos</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">doscar</span> <span class="o">=</span> <span class="n">VaspDoscar</span><span class="o">.</span><span class="n">parse_doscar</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;DOSCAR&quot;</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;dos.npy&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">doscar</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">efermi</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">float</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;grep E-fermi </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;OUTCAR&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="n">shift_efermi</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poscar</span> <span class="o">=</span> <span class="n">Poscar</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;POSCAR&quot;</span><span class="p">),</span>
            <span class="n">check_for_POTCAR</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">read_velocities</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forbitals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_f_orb</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;#FF0000&quot;</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;#0000FF&quot;</span><span class="p">,</span>
            <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;#008000&quot;</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;#800080&quot;</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;#E09200&quot;</span><span class="p">,</span>
            <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;#FF5C77&quot;</span><span class="p">,</span>
            <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;#778392&quot;</span><span class="p">,</span>
            <span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;#07C589&quot;</span><span class="p">,</span>
            <span class="mi">8</span><span class="p">:</span> <span class="s2">&quot;#40BAF2&quot;</span><span class="p">,</span>
            <span class="mi">9</span><span class="p">:</span> <span class="s2">&quot;#FF0000&quot;</span><span class="p">,</span>
            <span class="mi">10</span><span class="p">:</span> <span class="s2">&quot;#0000FF&quot;</span><span class="p">,</span>
            <span class="mi">11</span><span class="p">:</span> <span class="s2">&quot;#008000&quot;</span><span class="p">,</span>
            <span class="mi">12</span><span class="p">:</span> <span class="s2">&quot;#800080&quot;</span><span class="p">,</span>
            <span class="mi">13</span><span class="p">:</span> <span class="s2">&quot;#E09200&quot;</span><span class="p">,</span>
            <span class="mi">14</span><span class="p">:</span> <span class="s2">&quot;#FF5C77&quot;</span><span class="p">,</span>
            <span class="mi">15</span><span class="p">:</span> <span class="s2">&quot;#778392&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orbital_labels</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;p_</span><span class="si">{y}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;p_</span><span class="si">{x}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;p_</span><span class="si">{z}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;d_</span><span class="si">{xy}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;d_</span><span class="si">{yz}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;d_{z^</span><span class="si">{2}</span><span class="s2">}&quot;</span><span class="p">,</span>
            <span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;d_</span><span class="si">{xz}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="mi">8</span><span class="p">:</span> <span class="s2">&quot;d_{x^</span><span class="si">{2}</span><span class="s2">-y^</span><span class="si">{2}</span><span class="s2">}&quot;</span><span class="p">,</span>
            <span class="mi">9</span><span class="p">:</span> <span class="s2">&quot;f_{y^</span><span class="si">{3}</span><span class="s2">x^</span><span class="si">{2}</span><span class="s2">}&quot;</span><span class="p">,</span>
            <span class="mi">10</span><span class="p">:</span> <span class="s2">&quot;f_</span><span class="si">{xyz}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="mi">11</span><span class="p">:</span> <span class="s2">&quot;f_{yz^</span><span class="si">{2}</span><span class="s2">}&quot;</span><span class="p">,</span>
            <span class="mi">12</span><span class="p">:</span> <span class="s2">&quot;f_{z^</span><span class="si">{3}</span><span class="s2">}&quot;</span><span class="p">,</span>
            <span class="mi">13</span><span class="p">:</span> <span class="s2">&quot;f_{xz^</span><span class="si">{2}</span><span class="s2">}&quot;</span><span class="p">,</span>
            <span class="mi">14</span><span class="p">:</span> <span class="s2">&quot;f_{zx^</span><span class="si">{3}</span><span class="s2">}&quot;</span><span class="p">,</span>
            <span class="mi">15</span><span class="p">:</span> <span class="s2">&quot;f_{x^</span><span class="si">{3}</span><span class="s2">}&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spd_relations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="s2">&quot;LSORBIT&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">incar</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">incar</span><span class="p">[</span><span class="s2">&quot;LSORBIT&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="s2">&quot;ISPIN&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">incar</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">incar</span><span class="p">[</span><span class="s2">&quot;ISPIN&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ispin</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ispin</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ispin</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spin_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="n">Spin</span><span class="o">.</span><span class="n">up</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="n">Spin</span><span class="o">.</span><span class="n">down</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_tdos</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lorbit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_pdos</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;absolute&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">BaseException</span><span class="p">(</span>
                                <span class="s2">&quot;If using combination_method=&#39;add&#39; and spin orbit coupling is applied, just set spin=&#39;up&#39;&quot;</span>
                            <span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                            <span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                            <span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_f_orb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">f_elements</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;La&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Ac&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Ce&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Tb&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Th&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Dy&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pa&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Nd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Ho&quot;</span><span class="p">,</span>
            <span class="s2">&quot;U&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Er&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Np&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Sm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Tm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pu&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Eu&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Yb&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Am&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Gd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Lu&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">poscar</span><span class="o">.</span><span class="n">site_symbols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">f_elements</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">_check_f_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;DOSCAR&quot;</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_END</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_CUR</span><span class="p">)</span>
            <span class="n">last_line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

        <span class="n">last_line_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">last_line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">last_line_len</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_fix_doscar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">doscar</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;DOSCAR&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">split_line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">doscar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">split_line</span><span class="p">)</span>

        <span class="n">num_atoms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">doscar</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">nedos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">doscar</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">nedos_f</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nedos</span>
        <span class="n">start_inds</span> <span class="o">=</span> <span class="n">nedos</span> <span class="o">+</span> <span class="mi">7</span>

        <span class="n">top_file</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;DOSCAR&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">top_file</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="n">start_inds</span><span class="p">:</span>
                    <span class="k">break</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nedos_f</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nedos_f</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]]</span><span class="o">.</span><span class="n">T</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[[</span><span class="n">a</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">)]]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">nedos_f</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_atoms</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">inds</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">c</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="n">inds</span> <span class="o">+=</span> <span class="n">start_inds</span>

        <span class="n">new_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inds</span><span class="p">):</span>
            <span class="n">inbetween_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">:</span>
                <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;  &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">doscar</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">doscar</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">inds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;    &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">doscar</span><span class="p">[</span><span class="n">inbetween_ind</span><span class="p">]))</span>

        <span class="n">new_doscar</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">top_file</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_list</span><span class="p">)])</span>

        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;DOSCAR&quot;</span><span class="p">),</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;DOSCAR_old&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;DOSCAR&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">x</span><span class="p">:</span>
            <span class="n">x</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new_doscar</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_load_tdos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function loads the total density of states into a dictionary</span>

<span class="sd">        Returns:</span>
<span class="sd">            tdos_dict (dict[str][np.ndarray]): Dictionary that consists or the</span>
<span class="sd">                energies and densities of the system.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tdos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doscar</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span>
        <span class="n">tdos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tdos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">efermi</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span><span class="p">:</span>
            <span class="n">tdos</span> <span class="o">=</span> <span class="n">tdos</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
            <span class="n">tdos</span> <span class="o">=</span> <span class="n">tdos</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
            <span class="n">tdos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">tdos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
            <span class="n">tdos_up</span> <span class="o">=</span> <span class="n">tdos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">tdos_down</span> <span class="o">=</span> <span class="n">tdos</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
                <span class="n">tdos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">tdos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">tdos_up</span> <span class="o">+</span> <span class="n">tdos_down</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span><span class="p">:</span>
                    <span class="n">tdos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span>
                        <span class="n">tdos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                        <span class="p">(</span><span class="n">tdos_up</span> <span class="o">-</span> <span class="n">tdos_down</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">tdos_up</span> <span class="o">+</span> <span class="n">tdos_down</span><span class="p">),</span>
                    <span class="p">]</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;absolute&quot;</span><span class="p">:</span>
                    <span class="n">tdos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">tdos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">tdos_up</span> <span class="o">-</span> <span class="n">tdos_down</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">tdos</span>

    <span class="k">def</span> <span class="nf">_load_pdos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function loads the projected density of states into a dictionary</span>
<span class="sd">        of the form:</span>
<span class="sd">        atom index --&gt; orbital projections</span>

<span class="sd">        Returns:</span>
<span class="sd">            pdos_dict (dict[int][pd.DataFrame]): Dictionary that contains a data frame</span>
<span class="sd">                with the orbital weights for each atom index.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pdos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doscar</span><span class="p">[</span><span class="s2">&quot;projected&quot;</span><span class="p">]</span>
        <span class="n">pdos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">pdos</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbitals</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">pdos_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pdos</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                        <span class="n">pdos_up</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos_up</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ispin</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">pdos_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pdos</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                        <span class="n">pdos_up</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos_up</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ispin</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbitals</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="p">(</span>
                            <span class="s2">&quot;You have selected spin=&#39;down&#39; for a SOC calculation, but soc_axis has not been selected. Please set soc_axis to &#39;x&#39;, &#39;y&#39;, or &#39;z&#39; for this function to work.&quot;</span>
                        <span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">pdos_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pdos</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                        <span class="n">pdos_down</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="p">]</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos_down</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ispin</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="n">pdos</span> <span class="o">=</span> <span class="o">-</span><span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="p">(</span>
                            <span class="s2">&quot;You have selected spin=&#39;down&#39; for a SOC calculation, but soc_axis has not been selected. Please set soc_axis to &#39;x&#39;, &#39;y&#39;, or &#39;z&#39; for this function to work.&quot;</span>
                        <span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">pdos_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pdos</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                        <span class="n">pdos_down</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="p">]</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos_down</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ispin</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="n">pdos</span> <span class="o">=</span> <span class="o">-</span><span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbitals</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="p">(</span>
                            <span class="s2">&quot;You have selected spin=&#39;down&#39; for a SOC calculation, but soc_axis has not been selected. Please set soc_axis to &#39;x&#39;, &#39;y&#39;, or &#39;z&#39; for this function to work.&quot;</span>
                        <span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">pdos_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pdos</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                        <span class="n">pdos_up</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
                        <span class="n">pdos_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pdos</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                        <span class="n">pdos_down</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="n">pdos</span><span class="p">[</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="p">]</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ispin</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="n">pdos_up</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>
                    <span class="n">pdos_down</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="p">(</span>
                            <span class="s2">&quot;You have selected spin=&#39;down&#39; for a SOC calculation, but soc_axis has not been selected. Please set soc_axis to &#39;x&#39;, &#39;y&#39;, or &#39;z&#39; for this function to work.&quot;</span>
                        <span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                        <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">soc_axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">pdos_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pdos</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                        <span class="n">pdos_up</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
                        <span class="n">pdos_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pdos</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                        <span class="n">pdos_down</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="n">pdos</span><span class="p">[</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pdos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="p">]</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ispin</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsorbit</span><span class="p">:</span>
                    <span class="n">pdos_up</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>
                    <span class="n">pdos_down</span> <span class="o">=</span> <span class="n">pdos</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
                <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos_up</span> <span class="o">+</span> <span class="n">pdos_down</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span><span class="p">:</span>
                    <span class="n">pdos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pdos_up</span><span class="p">,</span> <span class="n">pdos_down</span><span class="p">])</span>
                    <span class="c1">#  pdos = (pdos_up - pdos_down) / (pdos_up + pdos_down)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;absolute&quot;</span><span class="p">:</span>
                    <span class="n">pdos</span> <span class="o">=</span> <span class="n">pdos_up</span> <span class="o">-</span> <span class="n">pdos_down</span>

        <span class="k">return</span> <span class="n">pdos</span>

    <span class="k">def</span> <span class="nf">_sum_spd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spd</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function sums the weights of the s, p, and d orbitals for each atom</span>
<span class="sd">        and creates a dictionary of the form:</span>
<span class="sd">        band index --&gt; s,p,d orbital weights</span>

<span class="sd">        Returns:</span>
<span class="sd">            spd_dict (dict([str][pd.DataFrame])): Dictionary that contains the summed weights for the s, p, and d orbitals for each band</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbitals</span><span class="p">:</span>
            <span class="n">spd_indices</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">spd_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">spd_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">spd_indices</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">:]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">spd_indices</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">spd_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">spd_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">spd_indices</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">spd_indices</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">9</span><span class="p">:]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
        <span class="p">):</span>
            <span class="n">orbital_contributions_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">orbital_contributions_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">spd_contributions_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">orbital_contributions_up</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">spd_indices</span>
                    <span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">spd_contributions_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">orbital_contributions_down</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">spd_indices</span>
                    <span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="n">spd_contributions_up</span> <span class="o">=</span> <span class="n">spd_contributions_up</span><span class="p">[</span>
                <span class="p">:,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">spd_relations</span><span class="p">[</span><span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">spd</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="n">spd_contributions_down</span> <span class="o">=</span> <span class="n">spd_contributions_down</span><span class="p">[</span>
                <span class="p">:,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">spd_relations</span><span class="p">[</span><span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">spd</span><span class="p">]</span>
            <span class="p">]</span>

            <span class="c1">#  spd_contributions = (spd_contributions_up - spd_contributions_down) / (spd_contributions_up + spd_contributions_down)</span>
            <span class="n">spd_contributions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">spd_contributions_up</span><span class="p">,</span> <span class="n">spd_contributions_down</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">orbital_contributions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">spd_contributions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">orbital_contributions</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">spd_indices</span>
                    <span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="n">spd_contributions</span> <span class="o">=</span> <span class="n">spd_contributions</span><span class="p">[</span>
                <span class="p">:,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">spd_relations</span><span class="p">[</span><span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">spd</span><span class="p">]</span>
            <span class="p">]</span>

        <span class="k">return</span> <span class="n">spd_contributions</span>

    <span class="k">def</span> <span class="nf">_sum_orbitals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orbitals</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function finds the weights of desired orbitals for all atoms and</span>
<span class="sd">            returns a dictionary of the form:</span>
<span class="sd">            band index --&gt; orbital index</span>

<span class="sd">        Parameters:</span>
<span class="sd">            orbitals (list): List of desired orbitals.</span>
<span class="sd">                0 = s</span>
<span class="sd">                1 = py</span>
<span class="sd">                2 = pz</span>
<span class="sd">                3 = px</span>
<span class="sd">                4 = dxy</span>
<span class="sd">                5 = dyz</span>
<span class="sd">                6 = dz2</span>
<span class="sd">                7 = dxz</span>
<span class="sd">                8 = dx2-y2</span>
<span class="sd">                9 = fy3x2</span>
<span class="sd">                10 = fxyz</span>
<span class="sd">                11 = fyz2</span>
<span class="sd">                12 = fz3</span>
<span class="sd">                13 = fxz2</span>
<span class="sd">                14 = fzx3</span>
<span class="sd">                15 = fx3</span>

<span class="sd">        Returns:</span>
<span class="sd">            orbital_dict (dict[str][pd.DataFrame]): Dictionary that contains the projected weights of the selected orbitals.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
        <span class="p">):</span>
            <span class="n">orbital_contributions_up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">orbital_contributions_down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">orbital_contributions_up</span> <span class="o">=</span> <span class="n">orbital_contributions_up</span><span class="p">[:,</span> <span class="n">orbitals</span><span class="p">]</span>
            <span class="n">orbital_contributions_down</span> <span class="o">=</span> <span class="n">orbital_contributions_down</span><span class="p">[</span>
                <span class="p">:,</span> <span class="n">orbitals</span>
            <span class="p">]</span>

            <span class="c1">#  orbital_contributions = (orbital_contributions_up - orbital_contributions_down) / (orbital_contributions_up + orbital_contributions_down)</span>
            <span class="n">orbital_contributions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">orbital_contributions_up</span><span class="p">,</span> <span class="n">orbital_contributions_down</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">orbital_contributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">orbital_contributions</span> <span class="o">=</span> <span class="n">orbital_contributions</span><span class="p">[:,</span> <span class="n">orbitals</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">orbital_contributions</span>

    <span class="k">def</span> <span class="nf">_sum_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">spd</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function finds the weights of desired atoms for all orbitals and</span>
<span class="sd">            returns a dictionary of the form:</span>
<span class="sd">            band index --&gt; atom index</span>

<span class="sd">        Parameters:</span>
<span class="sd">            atoms (list): List of desired atoms where atom 0 is the first atom in</span>
<span class="sd">                the POSCAR file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            atom_dict (dict[str][pd.DataFrame]): Dictionary that contains the projected</span>
<span class="sd">                weights of the selected atoms.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">spd</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbitals</span><span class="p">:</span>
                <span class="n">spd_indices</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="n">spd_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">spd_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">spd_indices</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">:]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">spd_indices</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="n">spd_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">spd_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">spd_indices</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">spd_indices</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">9</span><span class="p">:]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
            <span class="p">):</span>
                <span class="n">atoms_spd_up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">atoms_spd_down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">atoms_spd_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">atoms_spd_up</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">spd_indices</span>
                        <span class="p">]</span>
                    <span class="p">),</span>
                    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="n">atoms_spd_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">atoms_spd_down</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">spd_indices</span>
                        <span class="p">]</span>
                    <span class="p">),</span>
                    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="c1">#  atoms_spd = (atoms_spd_up - atoms_spd_down) / (atoms_spd_up + atoms_spd_down)</span>
                <span class="n">atoms_spd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">atoms_spd_up</span><span class="p">,</span> <span class="n">atoms_spd_down</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">atoms_spd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">spd_indices</span>
                        <span class="p">]</span>
                    <span class="p">),</span>
                    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">)</span>

            <span class="k">return</span> <span class="n">atoms_spd</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
            <span class="p">):</span>
                <span class="n">atoms_array_up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">atoms_array_down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="c1">#  atoms_array = (atoms_array_up - atoms_array_down) / (atoms_array_up + atoms_array_down)</span>
                <span class="k">if</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">atoms_array_up</span> <span class="o">=</span> <span class="n">atoms_array_up</span><span class="p">[:,</span> <span class="n">atoms</span><span class="p">]</span>
                    <span class="n">atoms_array_down</span> <span class="o">=</span> <span class="n">atoms_array_down</span><span class="p">[:,</span> <span class="n">atoms</span><span class="p">]</span>

                <span class="n">atoms_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">atoms_array_up</span><span class="p">,</span> <span class="n">atoms_array_down</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">atoms_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">atoms_array</span> <span class="o">=</span> <span class="n">atoms_array</span><span class="p">[:,</span> <span class="n">atoms</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">atoms_array</span>

    <span class="k">def</span> <span class="nf">_sum_elements</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">orbitals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spd_options</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function sums the weights of the orbitals of specific elements within the</span>
<span class="sd">        calculated structure and returns a dictionary of the form:</span>
<span class="sd">        band index --&gt; element label --&gt; orbital weights for orbitals = True</span>
<span class="sd">        band index --&gt; element label for orbitals = False</span>
<span class="sd">        This is useful for structures with many elements because manually entering indicies is</span>
<span class="sd">        not practical for large structures.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            elements (list): List of element symbols to sum the weights of.</span>
<span class="sd">            orbitals (bool): Determines whether or not to inclue orbitals or not</span>
<span class="sd">                (True = keep orbitals, False = sum orbitals together )</span>
<span class="sd">            spd (bool): Determines whether or not to sum the s, p, and d orbitals</span>


<span class="sd">        Returns:</span>
<span class="sd">            element_dict (dict([str][str][pd.DataFrame])): Dictionary that contains the summed weights for each orbital for a given element in the structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">poscar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">poscar</span>
        <span class="n">natoms</span> <span class="o">=</span> <span class="n">poscar</span><span class="o">.</span><span class="n">natoms</span>
        <span class="n">symbols</span> <span class="o">=</span> <span class="n">poscar</span><span class="o">.</span><span class="n">site_symbols</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
        <span class="p">):</span>
            <span class="n">pdos_array_up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">pdos_array_down</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">element_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="n">symbols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symbols</span><span class="p">))</span>
                <span class="p">]</span>
            <span class="p">)</span>

            <span class="n">element_indices</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">element_list</span><span class="p">,</span> <span class="n">element</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span>
            <span class="p">]</span>

            <span class="n">element_orbitals_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pdos_array_up</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">element_indices</span>
                    <span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">element_orbitals_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pdos_array_down</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">element_indices</span>
                    <span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">orbitals</span><span class="p">:</span>
                <span class="c1">#  element_orbitals = (element_orbitals_up - element_orbitals_down) / (element_orbitals_up + element_orbitals_down)</span>
                <span class="n">element_orbitals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">element_orbitals_up</span><span class="p">,</span> <span class="n">element_orbitals_down</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="n">element_orbitals</span>
            <span class="k">elif</span> <span class="n">spd</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbitals</span><span class="p">:</span>
                    <span class="n">spd_indices</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                    <span class="p">]</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">:]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">spd_indices</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
                    <span class="p">]</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">9</span><span class="p">:]</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="n">element_spd_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">element_orbitals_up</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">spd_indices</span>
                        <span class="p">]</span>
                    <span class="p">),</span>
                    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">)</span>

                <span class="n">element_spd_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">element_orbitals_down</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">spd_indices</span>
                        <span class="p">]</span>
                    <span class="p">),</span>
                    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">)</span>

                <span class="c1">#  element_spd = (element_spd_up - element_spd_down) / (element_spd_up + element_spd_down)</span>
                <span class="n">element_spd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">element_spd_up</span><span class="p">,</span> <span class="n">element_spd_down</span><span class="p">])</span>

                <span class="k">return</span> <span class="n">element_spd</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">element_array_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">element_orbitals_up</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">element_array_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">element_orbitals_down</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

                <span class="c1">#  element_array = (element_array_up - element_array_down) / (element_array_up + element_array_down)</span>
                <span class="n">element_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">element_array_up</span><span class="p">,</span> <span class="n">element_array_down</span><span class="p">]</span>
                <span class="p">)</span>

                <span class="k">return</span> <span class="n">element_array</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pdos_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span>

            <span class="n">element_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="n">symbols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symbols</span><span class="p">))</span>
                <span class="p">]</span>
            <span class="p">)</span>

            <span class="n">element_indices</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">element_list</span><span class="p">,</span> <span class="n">element</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span>
            <span class="p">]</span>

            <span class="n">element_orbitals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pdos_array</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">element_indices</span>
                    <span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">orbitals</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">element_orbitals</span>
            <span class="k">elif</span> <span class="n">spd</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbitals</span><span class="p">:</span>
                    <span class="n">spd_indices</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                    <span class="p">]</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">:]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">spd_indices</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
                    <span class="p">]</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">spd_indices</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">9</span><span class="p">:]</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="n">element_spd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">element_orbitals</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">spd_indices</span>
                        <span class="p">]</span>
                    <span class="p">),</span>
                    <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">)</span>

                <span class="k">return</span> <span class="n">element_spd</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">element_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">element_orbitals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">element_array</span>

    <span class="k">def</span> <span class="nf">_smear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dos</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function applied a 1D gaussian filter to the density of states</span>

<span class="sd">        Parameters:</span>
<span class="sd">            dos (np.ndarray): Array of densities.</span>
<span class="sd">            sigma (float): Standard deviation used in the gaussian filter.</span>


<span class="sd">        Returns:</span>
<span class="sd">            _smeared_dos (np.ndarray): Array of _smeared densities.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">avgdiff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
        <span class="n">_smeared_dos</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">dos</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">avgdiff</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_smeared_dos</span>

    <span class="k">def</span> <span class="nf">_set_density_lims</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">tdensity</span><span class="p">,</span>
        <span class="n">tenergy</span><span class="p">,</span>
        <span class="n">erange</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">spin</span><span class="p">,</span>
        <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">idx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">multiple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">energy_in_plot_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">tenergy</span> <span class="o">&gt;=</span> <span class="n">erange</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">tenergy</span> <span class="o">&lt;=</span> <span class="n">erange</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">tdensity</span> <span class="o">=</span> <span class="n">tdensity</span><span class="p">[</span><span class="n">energy_in_plot_index</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">tdensity</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">density_in_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">tdensity</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span> <span class="ow">or</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
                <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tdensity</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">density_in_plot</span> <span class="o">=</span> <span class="n">tdensity</span><span class="p">[:,</span> <span class="n">max_index</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">min_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">tdensity</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">density_in_plot</span> <span class="o">=</span> <span class="n">tdensity</span><span class="p">[:,</span> <span class="n">min_index</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">erange</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span> <span class="ow">or</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">),</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span>
                            <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">),</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">erange</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span> <span class="ow">or</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">),</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span>
                            <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">),</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">erange</span><span class="p">)</span>
                <span class="n">xlims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span> <span class="ow">or</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span> <span class="ow">or</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">erange</span><span class="p">)</span>
                <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span> <span class="ow">or</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span> <span class="ow">or</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">density_in_plot</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sum_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layers</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_layer_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">vaspvis.utils</span> <span class="kn">import</span> <span class="n">group_layers</span>

        <span class="k">if</span> <span class="n">custom_layer_inds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">groups</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">group_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poscar</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">groups</span> <span class="o">=</span> <span class="n">custom_layer_inds</span>
        <span class="n">atom_densities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_atoms</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
        <span class="p">):</span>
            <span class="n">densities_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">atom_densities</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">[</span><span class="n">group</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">densities_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">atom_densities</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">[</span><span class="n">group</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">summed_layers_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">densities_up</span><span class="p">[</span><span class="n">layers</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">summed_layers_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">densities_down</span><span class="p">[</span><span class="n">layers</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">summed_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">summed_layers_up</span><span class="p">,</span> <span class="n">summed_layers_down</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">densities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">atom_densities</span><span class="p">[:,</span> <span class="p">[</span><span class="n">group</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">summed_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">densities</span><span class="p">[</span><span class="n">layers</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">summed_layers</span>

    <span class="k">def</span> <span class="nf">_add_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">legend_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
            <span class="n">legend_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">(</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                    <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">legend_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>

        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">leg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">handles</span> <span class="o">=</span> <span class="n">legend_lines</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">legend_labels</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">_legmarker</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">leg</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">]</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">text</span><span class="o">.</span><span class="n">_text</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">leg</span><span class="o">.</span><span class="n">texts</span><span class="p">]</span>
            <span class="n">handles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">legend_lines</span><span class="p">)</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">legend_labels</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">handles</span><span class="p">,</span>
            <span class="n">labels</span><span class="p">,</span>
            <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">handletextpad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_plot_projected_general</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">energy</span><span class="p">,</span>
        <span class="n">projected_data</span><span class="p">,</span>
        <span class="n">colors</span><span class="p">,</span>
        <span class="n">sigma</span><span class="p">,</span>
        <span class="n">erange</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">,</span>
        <span class="n">fill</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">total</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">energy_in_plot_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">energy</span> <span class="o">&gt;=</span> <span class="n">erange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">energy</span> <span class="o">&lt;=</span> <span class="n">erange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span><span class="p">[</span><span class="n">energy_in_plot_index</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
        <span class="p">):</span>
            <span class="n">projected_data_up</span> <span class="o">=</span> <span class="n">projected_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">projected_data_down</span> <span class="o">=</span> <span class="n">projected_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">projected_data_up</span> <span class="o">=</span> <span class="n">projected_data_up</span><span class="p">[</span><span class="n">energy_in_plot_index</span><span class="p">]</span>
            <span class="n">projected_data_down</span> <span class="o">=</span> <span class="n">projected_data_down</span><span class="p">[</span><span class="n">energy_in_plot_index</span><span class="p">]</span>

            <span class="n">unique_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_colors</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
                <span class="n">plot_colors</span> <span class="o">=</span> <span class="n">colors</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unique_inds</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">unique_colors</span><span class="p">]</span>
                <span class="n">projected_data_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span>
                    <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">projected_data_up</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">unique_inds</span>
                    <span class="p">]</span>
                <span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
                <span class="n">projected_data_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span>
                    <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">projected_data_down</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">unique_inds</span>
                    <span class="p">]</span>
                <span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
                <span class="n">plot_colors</span> <span class="o">=</span> <span class="n">unique_colors</span>

            <span class="n">projected_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">projected_data_up</span> <span class="o">-</span> <span class="n">projected_data_down</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                <span class="n">projected_data_up</span> <span class="o">+</span> <span class="n">projected_data_down</span>
            <span class="p">)</span>
            <span class="n">projected_data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">projected_data</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1e-9</span>

            <span class="k">if</span> <span class="n">sigma</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">projected_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">projected_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_smear</span><span class="p">(</span>
                        <span class="n">projected_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span>
                        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">projected_data</span> <span class="o">=</span> <span class="n">projected_data</span><span class="p">[</span><span class="n">energy_in_plot_index</span><span class="p">]</span>

            <span class="n">unique_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_colors</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
                <span class="n">plot_colors</span> <span class="o">=</span> <span class="n">colors</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unique_inds</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">unique_colors</span><span class="p">]</span>
                <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span>
                    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">projected_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">unique_inds</span><span class="p">]</span>
                <span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
                <span class="n">plot_colors</span> <span class="o">=</span> <span class="n">unique_colors</span>

            <span class="k">if</span> <span class="n">sigma</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">projected_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">projected_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_smear</span><span class="p">(</span>
                        <span class="n">projected_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span>
                        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
                    <span class="p">)</span>

        <span class="k">if</span> <span class="n">total</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_plain</span><span class="p">(</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
                <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
                <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
                <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_density_lims</span><span class="p">(</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">tdensity</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
                <span class="n">tenergy</span><span class="o">=</span><span class="n">energy</span><span class="p">,</span>
                <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
                <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
                <span class="n">spin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="p">,</span>
                <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">projected_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>

            <span class="n">pdensity</span> <span class="o">=</span> <span class="n">projected_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">pdensity</span><span class="p">,</span>
                    <span class="n">energy</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">plot_colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span>
                        <span class="n">energy</span><span class="p">,</span>
                        <span class="n">pdensity</span><span class="p">,</span>
                        <span class="mi">0</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">plot_colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">energy</span><span class="p">,</span>
                    <span class="n">pdensity</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">plot_colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
                        <span class="n">energy</span><span class="p">,</span>
                        <span class="n">pdensity</span><span class="p">,</span>
                        <span class="mi">0</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">plot_colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_plain</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
        <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots the total density of states</span>

<span class="sd">        Parameters:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): Axis to append the tick labels</span>
<span class="sd">            linewidth (float): Linewidth of lines</span>
<span class="sd">            fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">            alpha (float): Alpha value for the fill</span>
<span class="sd">            alpha_line (float): Alpha value for the line</span>
<span class="sd">            sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">            energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">            color (str): Color of line</span>
<span class="sd">            erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tdos_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span>
        <span class="n">energy_in_plot_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">erange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">erange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">tdos_array</span> <span class="o">=</span> <span class="n">tdos_array</span><span class="p">[</span><span class="n">energy_in_plot_index</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">sigma</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tdensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_smear</span><span class="p">(</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tdensity</span> <span class="o">=</span> <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
            <span class="n">tdensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tdensity</span><span class="p">)</span>
            <span class="n">neg_inf_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">tdensity</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
            <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">tdensity</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">neg_inf_loc</span><span class="p">)])</span>
            <span class="n">tdensity</span><span class="p">[</span><span class="n">neg_inf_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_val</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_density_lims</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">tdensity</span><span class="o">=</span><span class="n">tdensity</span><span class="p">,</span>
            <span class="n">tenergy</span><span class="o">=</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
            <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
            <span class="n">spin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="p">,</span>
            <span class="n">log_scale</span><span class="o">=</span><span class="n">log_scale</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">tdensity</span><span class="p">,</span>
                <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span>
                    <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="n">tdensity</span><span class="p">,</span>
                    <span class="mi">0</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">tdensity</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
                    <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="n">tdensity</span><span class="p">,</span>
                    <span class="mi">0</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_ldos</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">layers</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
        <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">custom_layer_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots the total density of states</span>

<span class="sd">        Parameters:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): Axis to append the tick labels</span>
<span class="sd">            linewidth (float): Linewidth of lines</span>
<span class="sd">            fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">            alpha (float): Alpha value for the fill</span>
<span class="sd">            alpha_line (float): Alpha value for the line</span>
<span class="sd">            sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">            energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">            color (str): Color of line</span>
<span class="sd">            erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#  tdos_array = self._sum_layers(layers=layers)</span>
        <span class="n">tdos_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span>

        <span class="n">tdensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_layers</span><span class="p">(</span>
            <span class="n">layers</span><span class="o">=</span><span class="n">layers</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span> <span class="n">custom_layer_inds</span><span class="o">=</span><span class="n">custom_layer_inds</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
        <span class="p">):</span>
            <span class="n">tdensity</span> <span class="o">=</span> <span class="p">(</span><span class="n">tdensity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">tdensity</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span>
                <span class="n">tdensity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">tdensity</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">tdensity</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tdensity</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1e-9</span>

        <span class="k">if</span> <span class="n">sigma</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tdensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_smear</span><span class="p">(</span><span class="n">tdensity</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
            <span class="n">tdensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tdensity</span><span class="p">)</span>
            <span class="n">neg_inf_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">tdensity</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
            <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">tdensity</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">neg_inf_loc</span><span class="p">)])</span>
            <span class="n">tdensity</span><span class="p">[</span><span class="n">neg_inf_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_val</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_density_lims</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">tdensity</span><span class="o">=</span><span class="n">tdensity</span><span class="p">,</span>
            <span class="n">tenergy</span><span class="o">=</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
            <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
            <span class="n">spin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="p">,</span>
            <span class="n">log_scale</span><span class="o">=</span><span class="n">log_scale</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">tdensity</span><span class="p">,</span>
                <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span>
                    <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="n">tdensity</span><span class="p">,</span>
                    <span class="mi">0</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">tdensity</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
                    <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="n">tdensity</span><span class="p">,</span>
                    <span class="mi">0</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_spd</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">orbitals</span><span class="o">=</span><span class="s2">&quot;spd&quot;</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots the total density of states with the projected</span>
<span class="sd">        density of states for the total projections of the s, p, and d orbitals.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">            order (list): Order to plot the projected bands in. This feature helps to</span>
<span class="sd">                avoid situations where one projection completely convers the other.</span>
<span class="sd">            fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">            alpha (float): Alpha value for the fill</span>
<span class="sd">            alpha_line (float): Alpha value for the line</span>
<span class="sd">            linewidth (float): Linewidth of lines</span>
<span class="sd">            sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">            energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">            color_dict (dict[str][str]): This option allow the colors of the s, p, and d</span>
<span class="sd">                orbitals to be specified. Should be in the form of:</span>
<span class="sd">                {&#39;s&#39;: &lt;s color&gt;, &#39;p&#39;: &lt;p color&gt;, &#39;d&#39;: &lt;d color&gt;}</span>
<span class="sd">            legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">            total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">            erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_spd</span><span class="p">(</span><span class="n">spd</span><span class="o">=</span><span class="n">orbitals</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
            <span class="p">]</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">color_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbitals</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
            <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
            <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbitals</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_atom_orbitals</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">atom_orbital_dict</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots the total density of states with the projected</span>
<span class="sd">        density of states for the projections or orbitals on individual atoms.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">            atom_orbital_pairs (list[list]): List of atoms orbitals pairs in the form of</span>
<span class="sd">                [[atom index, orbital index], [atom index, orbital index], ..]</span>
<span class="sd">            fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">            alpha (float): Alpha value for the fill</span>
<span class="sd">            alpha_line (float): Alpha value for the line</span>
<span class="sd">            linewidth (float): Linewidth of lines</span>
<span class="sd">            sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">            energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">            color_list (list): List of colors that is the same length as the atom orbitals list</span>
<span class="sd">            legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">            total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">            erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">atom_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">atom_orbital_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">orbital_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">atom_orbital_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">number_orbitals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbital_indices</span><span class="p">]</span>
        <span class="n">atom_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">number_orbitals</span><span class="p">)</span>
        <span class="n">orbital_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
            <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">orbital_labels</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_indices</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">orbital_indices_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">orbital_indices</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">orbital_indices_long</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

        <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
        <span class="p">):</span>
            <span class="n">projected_data_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">projected_data_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">projected_data_up</span><span class="p">,</span> <span class="n">projected_data_down</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_indices_long</span><span class="p">))]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
            <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
            <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span>
                <span class="n">ax</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">orbital_symbols_long</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_orbitals</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">orbitals</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots the total density of states with the projected</span>
<span class="sd">        density of states for the projections onto given orbitals</span>

<span class="sd">        Parameters:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">            orbitals (list): List of orbitals to project onto</span>
<span class="sd">            fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">            alpha (float): Alpha value for the fill</span>
<span class="sd">            alpha_line (float): Alpha value for the line</span>
<span class="sd">            linewidth (float): Linewidth of lines</span>
<span class="sd">            sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">            energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">            color_dict (dict[str][str]): This option allow the colors of each orbital</span>
<span class="sd">                specified. Should be in the form of:</span>
<span class="sd">                {&#39;orbital index&#39;: &lt;color&gt;, &#39;orbital index&#39;: &lt;color&gt;, ...}</span>
<span class="sd">            legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">            total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">            erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbitals</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

        <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_orbitals</span><span class="p">(</span><span class="n">orbitals</span><span class="o">=</span><span class="n">orbitals</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
            <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
            <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span>
                <span class="n">ax</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">orbital_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbitals</span><span class="p">],</span>
                <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_atoms</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">atoms</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
        <span class="n">sum_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots the total density of states with the projected density of states on the given atoms.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">            atoms (list): Index of atoms to plot</span>
<span class="sd">            fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">            alpha (float): Alpha value for the fill</span>
<span class="sd">            alpha_line (float): Alpha value for the line</span>
<span class="sd">            color_list (list): Optional list of colors of the same length as the atoms list.</span>
<span class="sd">            linewidth (float): Linewidth of lines</span>
<span class="sd">            sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">            energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">            legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">            total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">            erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">))])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

        <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_atoms</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">)</span>

        <span class="c1">#  if sum_atoms:</span>
        <span class="c1">#  if self.spin == &#39;both&#39; and self.combination_method == &#39;sub&#39; and self.sp_method == &#39;percentage&#39;:</span>
        <span class="c1">#  projected_data_up = np.sum(projected_data[0], axis=1).reshape(-1,1)</span>
        <span class="c1">#  projected_data_up = np.sum(projected_data[1], axis=1).reshape(-1,1)</span>
        <span class="c1">#  colors = [colors[0]]</span>
        <span class="c1">#  else:</span>
        <span class="c1">#  projected_data = np.sum(projected_data, axis=1).reshape(-1,1)</span>
        <span class="c1">#  colors = [colors[0]]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
            <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
            <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_atom_spd</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">atom_spd_dict</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots the total density of states with the projected</span>
<span class="sd">        density of states onto the s, p, and d orbitals of specified atoms.</span>
<span class="sd">        This is useful for supercells where there are many atoms of the same</span>
<span class="sd">        atom and it is inconvienient to manually list each index in the POSCAR.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">            atoms (list): List of atom symbols to project onto</span>
<span class="sd">            order (list): Order to plot the projected bands in. This feature helps to</span>
<span class="sd">                avoid situations where one projection completely convers the other.</span>
<span class="sd">            fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">            alpha (float): Alpha value for the fill</span>
<span class="sd">            alpha_line (float): Alpha value for the line</span>
<span class="sd">            linewidth (float): Linewidth of lines</span>
<span class="sd">            sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">            energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">            color_dict (dict[str][str]): This option allow the colors of each atom</span>
<span class="sd">                specified. Should be in the form of:</span>
<span class="sd">                {&#39;atom index&#39;: &lt;color&gt;, &#39;atom index&#39;: &lt;color&gt;, ...}</span>
<span class="sd">            legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">            total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">            erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">atom_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">atom_spd_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">orbital_symbols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">atom_spd_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">number_orbitals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
        <span class="n">atom_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">number_orbitals</span><span class="p">)</span>
        <span class="n">orbital_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
            <span class="p">[[</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">orbital_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
            <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">spd_relations</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">orbital_indices</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

        <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_atoms</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">spd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
        <span class="p">):</span>
            <span class="n">projected_data_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">projected_data_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">projected_data_up</span><span class="p">,</span> <span class="n">projected_data_down</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_symbols_long</span><span class="p">))]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
            <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
            <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span>
                <span class="n">ax</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">orbital_symbols_long</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_elements</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">elements</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots the total density of states with the projected</span>
<span class="sd">        density of states for the projection onto specified elements. This is</span>
<span class="sd">        useful for supercells where there are many atoms of the same element and</span>
<span class="sd">        it is inconvienient to manually list each index in the POSCAR.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">            elements (list): List of element symbols to project onto</span>
<span class="sd">            fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">            alpha (float): Alpha value for the fill</span>
<span class="sd">            alpha_line (float): Alpha value for the line</span>
<span class="sd">            linewidth (float): Linewidth of lines</span>
<span class="sd">            sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">            energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">            color_list (list): List of colors that is the same length at the elements list</span>
<span class="sd">            legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">            total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">            erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">))]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

        <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_elements</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
            <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
            <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">elements</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_element_orbitals</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">element_orbital_dict</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots the total density of states with the projected</span>
<span class="sd">        density of states onto the chosen orbitals of specified elements. This is</span>
<span class="sd">        useful for supercells where there are many atoms of the same element and</span>
<span class="sd">        it is inconvienient to manually list each index in the POSCAR.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">            element_orbital_pairs (list[list]): List of element orbital pairs in the form of</span>
<span class="sd">                [[element symbol, orbital index], [element symbol, orbital index], ..]</span>
<span class="sd">            fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">            alpha (float): Alpha value for the fill</span>
<span class="sd">            alpha_line (float): Alpha value for the line</span>
<span class="sd">            linewidth (float): Linewidth of lines</span>
<span class="sd">            sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">            energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">            color_list (list): List of colors that is the same length as the element orbitals list</span>
<span class="sd">            legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">            total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">            erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">element_symbols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element_orbital_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">orbital_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element_orbital_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">number_orbitals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbital_indices</span><span class="p">]</span>
        <span class="n">element_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">element_symbols</span><span class="p">,</span> <span class="n">number_orbitals</span><span class="p">)</span>
        <span class="n">element_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
            <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">element_symbols</span><span class="p">)),</span> <span class="n">number_orbitals</span>
        <span class="p">)</span>
        <span class="n">orbital_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
            <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">orbital_labels</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_indices</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">orbital_indices_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">orbital_indices</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">element_indices</span><span class="p">,</span> <span class="n">orbital_indices_long</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

        <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_elements</span><span class="p">(</span>
            <span class="n">elements</span><span class="o">=</span><span class="n">element_symbols</span><span class="p">,</span> <span class="n">orbitals</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
        <span class="p">):</span>
            <span class="n">projected_data_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">projected_data_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">projected_data_up</span><span class="p">,</span> <span class="n">projected_data_down</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_indices_long</span><span class="p">))]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
            <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
            <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span>
                <span class="n">ax</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">element_symbols_long</span><span class="p">,</span> <span class="n">orbital_symbols_long</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_element_spd</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">element_spd_dict</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots the total density of states with the projected</span>
<span class="sd">        density of states onto the s, p, and d orbitals of specified elements.</span>
<span class="sd">        This is useful for supercells where there are many atoms of the same</span>
<span class="sd">        element and it is inconvienient to manually list each index in the POSCAR.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">            elements (list): List of element symbols to project onto</span>
<span class="sd">            order (list): Order to plot the projected bands in. This feature helps to</span>
<span class="sd">                avoid situations where one projection completely convers the other.</span>
<span class="sd">            fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">            alpha (float): Alpha value for the fill</span>
<span class="sd">            alpha_line (float): Alpha value for the line</span>
<span class="sd">            linewidth (float): Linewidth of lines</span>
<span class="sd">            sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">            energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">            color_dict (dict[str][str]): This option allow the colors of each element</span>
<span class="sd">                specified. Should be in the form of:</span>
<span class="sd">                {&#39;element index&#39;: &lt;color&gt;, &#39;element index&#39;: &lt;color&gt;, ...}</span>
<span class="sd">            legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">            total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">            erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">element_symbols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element_spd_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">orbital_symbols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element_spd_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">number_orbitals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
        <span class="n">element_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">element_symbols</span><span class="p">,</span> <span class="n">number_orbitals</span><span class="p">)</span>
        <span class="n">element_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
            <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">element_symbols</span><span class="p">)),</span> <span class="n">number_orbitals</span>
        <span class="p">)</span>
        <span class="n">orbital_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
            <span class="p">[[</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">orbital_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
            <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">spd_relations</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">element_indices</span><span class="p">,</span> <span class="n">orbital_indices</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

        <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_elements</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="n">element_symbols</span><span class="p">,</span> <span class="n">spd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
        <span class="p">):</span>
            <span class="n">projected_data_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">projected_data_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">projected_data_up</span><span class="p">,</span> <span class="n">projected_data_down</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">projected_data</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_symbols_long</span><span class="p">))]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
            <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
            <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
            <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span>
                <span class="n">ax</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">element_symbols_long</span><span class="p">,</span> <span class="n">orbital_symbols_long</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_layers</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma&quot;</span><span class="p">,</span>
        <span class="n">sigma_energy</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">sigma_layers</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
        <span class="n">lrange</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">antialiased</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
        <span class="n">interface_layer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">show_interface_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">interface_line_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
        <span class="n">interface_line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">interface_line_style</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">contour</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">min_cutoff</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span>
        <span class="n">max_cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">custom_layer_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">custom_cbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cbar_orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span>
        <span class="n">show_bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">set_bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function plots a layer by layer heat map of the density</span>
<span class="sd">        of states.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">            cmap (str): Color map to use in the heat map</span>
<span class="sd">            sigma_energy (float): Variance for a gaussian blur with respect to the energy</span>
<span class="sd">                This will help smooth out spikey looking density of states</span>
<span class="sd">            sigma_layers (float): Variance for a gaussian blur with respect to the layers</span>
<span class="sd">                This will help smooth out the the pixelation that can occur between the summed</span>
<span class="sd">                dos with respect to the layers.</span>
<span class="sd">            energyaxis (str): Axis to plot the energy on. (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">            erange (list): Upper and lower energy bounds for the plot.</span>
<span class="sd">            lrange (list): Upper and lower bounds of the layers included in the plot.</span>
<span class="sd">            antialiased (bool): Determines if antialiasing is used or not.</span>
<span class="sd">            fontsize (float): Fontsize of all the text in the group.</span>
<span class="sd">            interface_layer (float or None): If a value is provided, then the axis labels will be</span>
<span class="sd">                shifted accordingly so that the defined interface layer is zero.</span>
<span class="sd">            show_interface_line (bool): If True, then a line will be drawn</span>
<span class="sd">                on the plot to identify the interface layer defined by interface_layer.</span>
<span class="sd">            interface_line_color (str): Color of the line drawn on the plot to mark the</span>
<span class="sd">                interface.</span>
<span class="sd">            interface_line_width (float): Line with of the line marking the interface.</span>
<span class="sd">            interface_line_style (str): Style of the line marking the interface.</span>
<span class="sd">            log_scale (bool): Determines if the color map is applied in log scale of not.</span>
<span class="sd">                Recommended in order to accurately view the band gap and smaller features.</span>
<span class="sd">            contour (bool): Determines if the color map is plotted as a contour plot instead</span>
<span class="sd">                of a heatmap.</span>
<span class="sd">            levels (int): Number of levels used in the contour plot.</span>
<span class="sd">            min_cutoff (float): Minimum dos value used to determine the cut off for the plot.</span>
<span class="sd">                This can be adjusted to better visualize the band gap of the material.</span>
<span class="sd">            atol (float or None): Tolarence used in the grouping of the layers.</span>
<span class="sd">                This value is automatically calculated if None and is usually on the order of</span>
<span class="sd">                1e-3.</span>
<span class="sd">            custom_layer_inds (list or None): If the structure being calculated has relaxed</span>
<span class="sd">                atomic positions, sometimes the layer grouping algorithm can behave non-idealy.</span>
<span class="sd">                If this is the case, the user can input a list of list that contain the</span>
<span class="sd">                atomic indices in each layers of the material.</span>
<span class="sd">            custom_cbar_label (str or None): Custom label for the colorbar</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">vaspvis.utils</span> <span class="kn">import</span> <span class="n">group_layers</span>
        <span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>

        <span class="n">energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">erange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.1</span> <span class="o">&lt;=</span> <span class="n">energy</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">energy</span> <span class="o">&lt;=</span> <span class="n">erange</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">custom_layer_inds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">groups</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">group_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poscar</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">groups</span> <span class="o">=</span> <span class="n">custom_layer_inds</span>

        <span class="n">atom_index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">))</span>
        <span class="n">energies</span> <span class="o">=</span> <span class="n">energy</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

        <span class="n">atom_densities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_atoms</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
        <span class="p">):</span>
            <span class="n">atom_densities_up</span> <span class="o">=</span> <span class="n">atom_densities</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
            <span class="n">atom_densities_down</span> <span class="o">=</span> <span class="n">atom_densities</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
            <span class="n">densities_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">atom_densities_up</span><span class="p">[:,</span> <span class="p">[</span><span class="n">group</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">densities_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">atom_densities_down</span><span class="p">[:,</span> <span class="p">[</span><span class="n">group</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">densities</span> <span class="o">=</span> <span class="p">(</span><span class="n">densities_up</span> <span class="o">-</span> <span class="n">densities_down</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                <span class="n">densities_up</span> <span class="o">+</span> <span class="n">densities_down</span>
            <span class="p">)</span>
            <span class="n">densities</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">densities</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1e-9</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">atom_densities</span> <span class="o">=</span> <span class="n">atom_densities</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="n">densities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">atom_densities</span><span class="p">[:,</span> <span class="p">[</span><span class="n">group</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="n">densities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">lrange</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">atom_index</span> <span class="o">=</span> <span class="n">atom_index</span><span class="p">[</span><span class="n">lrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">lrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">densities</span> <span class="o">=</span> <span class="n">densities</span><span class="p">[:,</span> <span class="n">lrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">lrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">sigma_energy</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">densities</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_smear</span><span class="p">(</span>
                    <span class="n">densities</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span>
                    <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_energy</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="n">sigma_layers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">densities</span> <span class="o">=</span> <span class="n">gaussian_filter</span><span class="p">(</span><span class="n">densities</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_layers</span><span class="p">)</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">interp2d</span><span class="p">(</span><span class="n">atom_index</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">densities</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;cubic&quot;</span><span class="p">)</span>
        <span class="n">atom_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">atom_index</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">atom_index</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">densities</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">atom_index</span><span class="p">,</span> <span class="n">energies</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">neg_zero_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">densities</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">pos_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">densities</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">densities</span><span class="p">[</span><span class="n">pos_loc</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">min_val</span> <span class="o">&lt;</span> <span class="n">min_cutoff</span><span class="p">:</span>
                    <span class="n">min_val</span> <span class="o">=</span> <span class="n">min_cutoff</span>
                    <span class="n">too_small_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">densities</span> <span class="o">&lt;</span> <span class="n">min_cutoff</span><span class="p">)</span>
                    <span class="n">densities</span><span class="p">[</span><span class="n">too_small_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_cutoff</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">densities</span><span class="p">[</span><span class="n">neg_zero_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">min_val</span> <span class="o">&lt;</span> <span class="n">min_cutoff</span><span class="p">:</span>
                    <span class="n">min_val</span> <span class="o">=</span> <span class="n">min_cutoff</span>

            <span class="k">if</span> <span class="n">max_cutoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">max_val</span> <span class="o">=</span> <span class="n">max_cutoff</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span>

            <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">min_val</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">max_val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">set_bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">norm_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">densities</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">densities</span><span class="p">)])</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">norm_val</span> <span class="o">=</span> <span class="n">set_bounds</span>

                <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="n">norm_val</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">norm_val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">max_cutoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">max_val</span> <span class="o">=</span> <span class="n">max_cutoff</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">min_cutoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">min_val</span> <span class="o">=</span> <span class="n">min_cutoff</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span>

                <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">min_val</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">max_val</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
            <span class="n">lev_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lev_exp</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">levels</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">levels</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">lev_exp</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">lev_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="mf">0.25</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lev_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="mf">0.5</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">lev_exp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">interface_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">atom_index</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">interface_layer</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">contour</span><span class="p">:</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
                    <span class="n">atom_index</span><span class="p">,</span>
                    <span class="n">energies</span><span class="p">,</span>
                    <span class="n">densities</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                    <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                    <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
                    <span class="n">atom_index</span><span class="p">,</span>
                    <span class="n">energies</span><span class="p">,</span>
                    <span class="n">densities</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                    <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;gouraud&quot;</span><span class="p">,</span>
                    <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                    <span class="n">antialiased</span><span class="o">=</span><span class="n">antialiased</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">interface_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">show_interface_line</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">interface_line_color</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="n">interface_line_style</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="n">interface_line_width</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">contour</span><span class="p">:</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
                    <span class="n">energies</span><span class="p">,</span>
                    <span class="n">atom_index</span><span class="p">,</span>
                    <span class="n">densities</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                    <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                    <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
                    <span class="n">energies</span><span class="p">,</span>
                    <span class="n">atom_index</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">densities</span><span class="p">),</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                    <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;gouraud&quot;</span><span class="p">,</span>
                    <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                    <span class="n">antialiased</span><span class="o">=</span><span class="n">antialiased</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">interface_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">show_interface_line</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
                    <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">interface_line_color</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="n">interface_line_style</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="n">interface_line_width</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">cbar_orientation</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">custom_cbar_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Spin Polarization&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
                <span class="n">min_val</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">vmin</span>
                <span class="n">max_val</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">vmax</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">show_bounds</span><span class="p">:</span>
                    <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s2">&quot;Down&quot;</span><span class="p">,</span> <span class="s2">&quot;Up&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Density of States&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">custom_cbar_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">]):</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">poscar</span><span class="o">.</span><span class="n">structure</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="n">AseAtomsAdaptor</span><span class="p">()</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="n">plot_atoms</span><span class="p">(</span>
            <span class="n">atoms</span><span class="p">,</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="n">radii</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">rotation</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rotation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">x,</span><span class="si">{</span><span class="n">rotation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">y,</span><span class="si">{</span><span class="n">rotation</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">z&quot;</span><span class="p">),</span>
            <span class="n">show_unit_cell</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="vaspvis.dos.Dos.plot_atom_orbitals" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_atom_orbitals</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">atom_orbital_dict</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">energyaxis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function plots the total density of states with the projected
density of states for the projections or orbitals on individual atoms.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.pyplot.axis">axis</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to plot on</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>atom_orbital_pairs</code></td>
          <td>
                <code>list[list]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of atoms orbitals pairs in the form of
[[atom index, orbital index], [atom index, orbital index], ..]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fill</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wether or not to fill underneath the plot</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the fill</p>
            </div>
          </td>
          <td>
                <code>0.3</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha_line</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the line</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>linewidth</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Linewidth of lines</p>
            </div>
          </td>
          <td>
                <code>1.5</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard deviation for gaussian filter</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>energyaxis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines the axis to plot the energy on ('x' or 'y')</p>
            </div>
          </td>
          <td>
                <code>&#39;y&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>color_list</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of colors that is the same length as the atom orbitals list</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>legend</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines whether to draw the legend or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>total</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wheth to draw the total density of states or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>erange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Energy range for the DOS plot ([lower bound, upper bound])</p>
            </div>
          </td>
          <td>
                <code>[-6, 6]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>vaspvis/dos.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_atom_orbitals</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">atom_orbital_dict</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the total density of states with the projected</span>
<span class="sd">    density of states for the projections or orbitals on individual atoms.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">        atom_orbital_pairs (list[list]): List of atoms orbitals pairs in the form of</span>
<span class="sd">            [[atom index, orbital index], [atom index, orbital index], ..]</span>
<span class="sd">        fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">        alpha (float): Alpha value for the fill</span>
<span class="sd">        alpha_line (float): Alpha value for the line</span>
<span class="sd">        linewidth (float): Linewidth of lines</span>
<span class="sd">        sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">        energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">        color_list (list): List of colors that is the same length as the atom orbitals list</span>
<span class="sd">        legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">        total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">        erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">atom_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">atom_orbital_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">orbital_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">atom_orbital_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">number_orbitals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbital_indices</span><span class="p">]</span>
    <span class="n">atom_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">number_orbitals</span><span class="p">)</span>
    <span class="n">orbital_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
        <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">orbital_labels</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_indices</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">orbital_indices_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">orbital_indices</span><span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">orbital_indices_long</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

    <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdos_array</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
    <span class="p">):</span>
        <span class="n">projected_data_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">projected_data_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">projected_data_up</span><span class="p">,</span> <span class="n">projected_data_down</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_indices_long</span><span class="p">))]</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="n">names</span><span class="o">=</span><span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">orbital_symbols_long</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="vaspvis.dos.Dos.plot_atom_spd" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_atom_spd</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">atom_spd_dict</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">energyaxis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function plots the total density of states with the projected
density of states onto the s, p, and d orbitals of specified atoms.
This is useful for supercells where there are many atoms of the same
atom and it is inconvienient to manually list each index in the POSCAR.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.pyplot.axis">axis</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to plot on</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>atoms</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of atom symbols to project onto</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>order</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Order to plot the projected bands in. This feature helps to
avoid situations where one projection completely convers the other.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fill</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wether or not to fill underneath the plot</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the fill</p>
            </div>
          </td>
          <td>
                <code>0.3</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha_line</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the line</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>linewidth</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Linewidth of lines</p>
            </div>
          </td>
          <td>
                <code>1.5</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard deviation for gaussian filter</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>energyaxis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines the axis to plot the energy on ('x' or 'y')</p>
            </div>
          </td>
          <td>
                <code>&#39;y&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>color_dict</code></td>
          <td>
                <code>dict[str][str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This option allow the colors of each atom
specified. Should be in the form of:
{'atom index': <color>, 'atom index': <color>, ...}</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>legend</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines whether to draw the legend or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>total</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wheth to draw the total density of states or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>erange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Energy range for the DOS plot ([lower bound, upper bound])</p>
            </div>
          </td>
          <td>
                <code>[-6, 6]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>vaspvis/dos.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_atom_spd</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">atom_spd_dict</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the total density of states with the projected</span>
<span class="sd">    density of states onto the s, p, and d orbitals of specified atoms.</span>
<span class="sd">    This is useful for supercells where there are many atoms of the same</span>
<span class="sd">    atom and it is inconvienient to manually list each index in the POSCAR.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">        atoms (list): List of atom symbols to project onto</span>
<span class="sd">        order (list): Order to plot the projected bands in. This feature helps to</span>
<span class="sd">            avoid situations where one projection completely convers the other.</span>
<span class="sd">        fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">        alpha (float): Alpha value for the fill</span>
<span class="sd">        alpha_line (float): Alpha value for the line</span>
<span class="sd">        linewidth (float): Linewidth of lines</span>
<span class="sd">        sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">        energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">        color_dict (dict[str][str]): This option allow the colors of each atom</span>
<span class="sd">            specified. Should be in the form of:</span>
<span class="sd">            {&#39;atom index&#39;: &lt;color&gt;, &#39;atom index&#39;: &lt;color&gt;, ...}</span>
<span class="sd">        legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">        total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">        erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">atom_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">atom_spd_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">orbital_symbols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">atom_spd_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">number_orbitals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
    <span class="n">atom_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">number_orbitals</span><span class="p">)</span>
    <span class="n">orbital_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
        <span class="p">[[</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">orbital_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
        <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">spd_relations</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">orbital_indices</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

    <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_atoms</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">spd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
    <span class="p">):</span>
        <span class="n">projected_data_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">projected_data_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">projected_data_up</span><span class="p">,</span> <span class="n">projected_data_down</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_symbols_long</span><span class="p">))]</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="n">names</span><span class="o">=</span><span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">orbital_symbols_long</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="vaspvis.dos.Dos.plot_atoms" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_atoms</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">energyaxis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">sum_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function plots the total density of states with the projected density of states on the given atoms.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.pyplot.axis">axis</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to plot on</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>atoms</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Index of atoms to plot</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fill</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wether or not to fill underneath the plot</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the fill</p>
            </div>
          </td>
          <td>
                <code>0.3</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha_line</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the line</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>color_list</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional list of colors of the same length as the atoms list.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>linewidth</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Linewidth of lines</p>
            </div>
          </td>
          <td>
                <code>1.5</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard deviation for gaussian filter</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>energyaxis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines the axis to plot the energy on ('x' or 'y')</p>
            </div>
          </td>
          <td>
                <code>&#39;y&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>legend</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines whether to draw the legend or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>total</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wheth to draw the total density of states or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>erange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Energy range for the DOS plot ([lower bound, upper bound])</p>
            </div>
          </td>
          <td>
                <code>[-6, 6]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>vaspvis/dos.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_atoms</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">atoms</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="n">sum_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the total density of states with the projected density of states on the given atoms.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">        atoms (list): Index of atoms to plot</span>
<span class="sd">        fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">        alpha (float): Alpha value for the fill</span>
<span class="sd">        alpha_line (float): Alpha value for the line</span>
<span class="sd">        color_list (list): Optional list of colors of the same length as the atoms list.</span>
<span class="sd">        linewidth (float): Linewidth of lines</span>
<span class="sd">        sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">        energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">        legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">        total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">        erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">))])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

    <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_atoms</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">)</span>

    <span class="c1">#  if sum_atoms:</span>
    <span class="c1">#  if self.spin == &#39;both&#39; and self.combination_method == &#39;sub&#39; and self.sp_method == &#39;percentage&#39;:</span>
    <span class="c1">#  projected_data_up = np.sum(projected_data[0], axis=1).reshape(-1,1)</span>
    <span class="c1">#  projected_data_up = np.sum(projected_data[1], axis=1).reshape(-1,1)</span>
    <span class="c1">#  colors = [colors[0]]</span>
    <span class="c1">#  else:</span>
    <span class="c1">#  projected_data = np.sum(projected_data, axis=1).reshape(-1,1)</span>
    <span class="c1">#  colors = [colors[0]]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="vaspvis.dos.Dos.plot_element_orbitals" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_element_orbitals</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">element_orbital_dict</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">energyaxis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function plots the total density of states with the projected
density of states onto the chosen orbitals of specified elements. This is
useful for supercells where there are many atoms of the same element and
it is inconvienient to manually list each index in the POSCAR.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.pyplot.axis">axis</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to plot on</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>element_orbital_pairs</code></td>
          <td>
                <code>list[list]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of element orbital pairs in the form of
[[element symbol, orbital index], [element symbol, orbital index], ..]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fill</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wether or not to fill underneath the plot</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the fill</p>
            </div>
          </td>
          <td>
                <code>0.3</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha_line</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the line</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>linewidth</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Linewidth of lines</p>
            </div>
          </td>
          <td>
                <code>1.5</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard deviation for gaussian filter</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>energyaxis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines the axis to plot the energy on ('x' or 'y')</p>
            </div>
          </td>
          <td>
                <code>&#39;y&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>color_list</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of colors that is the same length as the element orbitals list</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>legend</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines whether to draw the legend or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>total</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wheth to draw the total density of states or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>erange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Energy range for the DOS plot ([lower bound, upper bound])</p>
            </div>
          </td>
          <td>
                <code>[-6, 6]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>vaspvis/dos.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_element_orbitals</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">element_orbital_dict</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the total density of states with the projected</span>
<span class="sd">    density of states onto the chosen orbitals of specified elements. This is</span>
<span class="sd">    useful for supercells where there are many atoms of the same element and</span>
<span class="sd">    it is inconvienient to manually list each index in the POSCAR.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">        element_orbital_pairs (list[list]): List of element orbital pairs in the form of</span>
<span class="sd">            [[element symbol, orbital index], [element symbol, orbital index], ..]</span>
<span class="sd">        fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">        alpha (float): Alpha value for the fill</span>
<span class="sd">        alpha_line (float): Alpha value for the line</span>
<span class="sd">        linewidth (float): Linewidth of lines</span>
<span class="sd">        sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">        energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">        color_list (list): List of colors that is the same length as the element orbitals list</span>
<span class="sd">        legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">        total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">        erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">element_symbols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element_orbital_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">orbital_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element_orbital_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">number_orbitals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbital_indices</span><span class="p">]</span>
    <span class="n">element_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">element_symbols</span><span class="p">,</span> <span class="n">number_orbitals</span><span class="p">)</span>
    <span class="n">element_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">element_symbols</span><span class="p">)),</span> <span class="n">number_orbitals</span>
    <span class="p">)</span>
    <span class="n">orbital_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
        <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">orbital_labels</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_indices</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">orbital_indices_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">orbital_indices</span><span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">element_indices</span><span class="p">,</span> <span class="n">orbital_indices_long</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

    <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_elements</span><span class="p">(</span>
        <span class="n">elements</span><span class="o">=</span><span class="n">element_symbols</span><span class="p">,</span> <span class="n">orbitals</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
    <span class="p">):</span>
        <span class="n">projected_data_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">projected_data_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">projected_data_up</span><span class="p">,</span> <span class="n">projected_data_down</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_indices_long</span><span class="p">))]</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="n">names</span><span class="o">=</span><span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">element_symbols_long</span><span class="p">,</span> <span class="n">orbital_symbols_long</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="vaspvis.dos.Dos.plot_element_spd" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_element_spd</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">element_spd_dict</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">energyaxis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function plots the total density of states with the projected
density of states onto the s, p, and d orbitals of specified elements.
This is useful for supercells where there are many atoms of the same
element and it is inconvienient to manually list each index in the POSCAR.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.pyplot.axis">axis</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to plot on</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>elements</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of element symbols to project onto</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>order</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Order to plot the projected bands in. This feature helps to
avoid situations where one projection completely convers the other.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fill</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wether or not to fill underneath the plot</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the fill</p>
            </div>
          </td>
          <td>
                <code>0.3</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha_line</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the line</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>linewidth</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Linewidth of lines</p>
            </div>
          </td>
          <td>
                <code>1.5</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard deviation for gaussian filter</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>energyaxis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines the axis to plot the energy on ('x' or 'y')</p>
            </div>
          </td>
          <td>
                <code>&#39;y&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>color_dict</code></td>
          <td>
                <code>dict[str][str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This option allow the colors of each element
specified. Should be in the form of:
{'element index': <color>, 'element index': <color>, ...}</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>legend</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines whether to draw the legend or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>total</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wheth to draw the total density of states or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>erange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Energy range for the DOS plot ([lower bound, upper bound])</p>
            </div>
          </td>
          <td>
                <code>[-6, 6]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>vaspvis/dos.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_element_spd</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">element_spd_dict</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the total density of states with the projected</span>
<span class="sd">    density of states onto the s, p, and d orbitals of specified elements.</span>
<span class="sd">    This is useful for supercells where there are many atoms of the same</span>
<span class="sd">    element and it is inconvienient to manually list each index in the POSCAR.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">        elements (list): List of element symbols to project onto</span>
<span class="sd">        order (list): Order to plot the projected bands in. This feature helps to</span>
<span class="sd">            avoid situations where one projection completely convers the other.</span>
<span class="sd">        fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">        alpha (float): Alpha value for the fill</span>
<span class="sd">        alpha_line (float): Alpha value for the line</span>
<span class="sd">        linewidth (float): Linewidth of lines</span>
<span class="sd">        sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">        energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">        color_dict (dict[str][str]): This option allow the colors of each element</span>
<span class="sd">            specified. Should be in the form of:</span>
<span class="sd">            {&#39;element index&#39;: &lt;color&gt;, &#39;element index&#39;: &lt;color&gt;, ...}</span>
<span class="sd">        legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">        total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">        erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_symbols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element_spd_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">orbital_symbols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element_spd_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">number_orbitals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
    <span class="n">element_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">element_symbols</span><span class="p">,</span> <span class="n">number_orbitals</span><span class="p">)</span>
    <span class="n">element_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">element_symbols</span><span class="p">)),</span> <span class="n">number_orbitals</span>
    <span class="p">)</span>
    <span class="n">orbital_symbols_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
        <span class="p">[[</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">orbital_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
        <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">spd_relations</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">]</span> <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">orbital_symbols</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">element_indices</span><span class="p">,</span> <span class="n">orbital_indices</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

    <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_elements</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="n">element_symbols</span><span class="p">,</span> <span class="n">spd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
    <span class="p">):</span>
        <span class="n">projected_data_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">projected_data_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">projected_data_up</span><span class="p">,</span> <span class="n">projected_data_down</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">projected_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">projected_data</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_symbols_long</span><span class="p">))]</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="n">names</span><span class="o">=</span><span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">element_symbols_long</span><span class="p">,</span> <span class="n">orbital_symbols_long</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="vaspvis.dos.Dos.plot_elements" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_elements</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">energyaxis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function plots the total density of states with the projected
density of states for the projection onto specified elements. This is
useful for supercells where there are many atoms of the same element and
it is inconvienient to manually list each index in the POSCAR.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.pyplot.axis">axis</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to plot on</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>elements</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of element symbols to project onto</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fill</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wether or not to fill underneath the plot</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the fill</p>
            </div>
          </td>
          <td>
                <code>0.3</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha_line</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the line</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>linewidth</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Linewidth of lines</p>
            </div>
          </td>
          <td>
                <code>1.5</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard deviation for gaussian filter</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>energyaxis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines the axis to plot the energy on ('x' or 'y')</p>
            </div>
          </td>
          <td>
                <code>&#39;y&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>color_list</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of colors that is the same length at the elements list</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>legend</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines whether to draw the legend or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>total</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wheth to draw the total density of states or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>erange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Energy range for the DOS plot ([lower bound, upper bound])</p>
            </div>
          </td>
          <td>
                <code>[-6, 6]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>vaspvis/dos.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_elements</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">elements</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the total density of states with the projected</span>
<span class="sd">    density of states for the projection onto specified elements. This is</span>
<span class="sd">    useful for supercells where there are many atoms of the same element and</span>
<span class="sd">    it is inconvienient to manually list each index in the POSCAR.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">        elements (list): List of element symbols to project onto</span>
<span class="sd">        fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">        alpha (float): Alpha value for the fill</span>
<span class="sd">        alpha_line (float): Alpha value for the line</span>
<span class="sd">        linewidth (float): Linewidth of lines</span>
<span class="sd">        sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">        energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">        color_list (list): List of colors that is the same length at the elements list</span>
<span class="sd">        legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">        total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">        erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">))]</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

    <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_elements</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">elements</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="vaspvis.dos.Dos.plot_layers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_layers</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">sigma_energy</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">sigma_layers</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">energyaxis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">lrange</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">interface_layer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_interface_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interface_line_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">interface_line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">interface_line_style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">contour</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_cutoff</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span> <span class="n">max_cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_layer_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_cbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cbar_orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">show_bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">set_bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function plots a layer by layer heat map of the density
of states.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.pyplot.axis">axis</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to plot on</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cmap</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Color map to use in the heat map</p>
            </div>
          </td>
          <td>
                <code>&#39;magma&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma_energy</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Variance for a gaussian blur with respect to the energy
This will help smooth out spikey looking density of states</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma_layers</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Variance for a gaussian blur with respect to the layers
This will help smooth out the the pixelation that can occur between the summed
dos with respect to the layers.</p>
            </div>
          </td>
          <td>
                <code>0.75</code>
          </td>
        </tr>
        <tr>
          <td><code>energyaxis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to plot the energy on. ('x' or 'y')</p>
            </div>
          </td>
          <td>
                <code>&#39;y&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>erange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Upper and lower energy bounds for the plot.</p>
            </div>
          </td>
          <td>
                <code>[-6, 6]</code>
          </td>
        </tr>
        <tr>
          <td><code>lrange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Upper and lower bounds of the layers included in the plot.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>antialiased</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines if antialiasing is used or not.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>fontsize</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Fontsize of all the text in the group.</p>
            </div>
          </td>
          <td>
                <code>6</code>
          </td>
        </tr>
        <tr>
          <td><code>interface_layer</code></td>
          <td>
                <code>float or None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If a value is provided, then the axis labels will be
shifted accordingly so that the defined interface layer is zero.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>show_interface_line</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, then a line will be drawn
on the plot to identify the interface layer defined by interface_layer.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>interface_line_color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Color of the line drawn on the plot to mark the
interface.</p>
            </div>
          </td>
          <td>
                <code>&#39;white&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>interface_line_width</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Line with of the line marking the interface.</p>
            </div>
          </td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>interface_line_style</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Style of the line marking the interface.</p>
            </div>
          </td>
          <td>
                <code>&#39;--&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>log_scale</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines if the color map is applied in log scale of not.
Recommended in order to accurately view the band gap and smaller features.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>contour</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines if the color map is plotted as a contour plot instead
of a heatmap.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>levels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of levels used in the contour plot.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>min_cutoff</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Minimum dos value used to determine the cut off for the plot.
This can be adjusted to better visualize the band gap of the material.</p>
            </div>
          </td>
          <td>
                <code>1e-07</code>
          </td>
        </tr>
        <tr>
          <td><code>atol</code></td>
          <td>
                <code>float or None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tolarence used in the grouping of the layers.
This value is automatically calculated if None and is usually on the order of
1e-3.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>custom_layer_inds</code></td>
          <td>
                <code>list or None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the structure being calculated has relaxed
atomic positions, sometimes the layer grouping algorithm can behave non-idealy.
If this is the case, the user can input a list of list that contain the
atomic indices in each layers of the material.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>custom_cbar_label</code></td>
          <td>
                <code>str or None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Custom label for the colorbar</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>vaspvis/dos.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_layers</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma&quot;</span><span class="p">,</span>
    <span class="n">sigma_energy</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">sigma_layers</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
    <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="n">lrange</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">antialiased</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">interface_layer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">show_interface_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">interface_line_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">interface_line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">interface_line_style</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
    <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">contour</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">min_cutoff</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span>
    <span class="n">max_cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">custom_layer_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">custom_cbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cbar_orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span>
    <span class="n">show_bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">set_bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots a layer by layer heat map of the density</span>
<span class="sd">    of states.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">        cmap (str): Color map to use in the heat map</span>
<span class="sd">        sigma_energy (float): Variance for a gaussian blur with respect to the energy</span>
<span class="sd">            This will help smooth out spikey looking density of states</span>
<span class="sd">        sigma_layers (float): Variance for a gaussian blur with respect to the layers</span>
<span class="sd">            This will help smooth out the the pixelation that can occur between the summed</span>
<span class="sd">            dos with respect to the layers.</span>
<span class="sd">        energyaxis (str): Axis to plot the energy on. (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">        erange (list): Upper and lower energy bounds for the plot.</span>
<span class="sd">        lrange (list): Upper and lower bounds of the layers included in the plot.</span>
<span class="sd">        antialiased (bool): Determines if antialiasing is used or not.</span>
<span class="sd">        fontsize (float): Fontsize of all the text in the group.</span>
<span class="sd">        interface_layer (float or None): If a value is provided, then the axis labels will be</span>
<span class="sd">            shifted accordingly so that the defined interface layer is zero.</span>
<span class="sd">        show_interface_line (bool): If True, then a line will be drawn</span>
<span class="sd">            on the plot to identify the interface layer defined by interface_layer.</span>
<span class="sd">        interface_line_color (str): Color of the line drawn on the plot to mark the</span>
<span class="sd">            interface.</span>
<span class="sd">        interface_line_width (float): Line with of the line marking the interface.</span>
<span class="sd">        interface_line_style (str): Style of the line marking the interface.</span>
<span class="sd">        log_scale (bool): Determines if the color map is applied in log scale of not.</span>
<span class="sd">            Recommended in order to accurately view the band gap and smaller features.</span>
<span class="sd">        contour (bool): Determines if the color map is plotted as a contour plot instead</span>
<span class="sd">            of a heatmap.</span>
<span class="sd">        levels (int): Number of levels used in the contour plot.</span>
<span class="sd">        min_cutoff (float): Minimum dos value used to determine the cut off for the plot.</span>
<span class="sd">            This can be adjusted to better visualize the band gap of the material.</span>
<span class="sd">        atol (float or None): Tolarence used in the grouping of the layers.</span>
<span class="sd">            This value is automatically calculated if None and is usually on the order of</span>
<span class="sd">            1e-3.</span>
<span class="sd">        custom_layer_inds (list or None): If the structure being calculated has relaxed</span>
<span class="sd">            atomic positions, sometimes the layer grouping algorithm can behave non-idealy.</span>
<span class="sd">            If this is the case, the user can input a list of list that contain the</span>
<span class="sd">            atomic indices in each layers of the material.</span>
<span class="sd">        custom_cbar_label (str or None): Custom label for the colorbar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">vaspvis.utils</span> <span class="kn">import</span> <span class="n">group_layers</span>
    <span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>

    <span class="n">energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="p">(</span><span class="n">erange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.1</span> <span class="o">&lt;=</span> <span class="n">energy</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">energy</span> <span class="o">&lt;=</span> <span class="n">erange</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">custom_layer_inds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">groups</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">group_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poscar</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">custom_layer_inds</span>

    <span class="n">atom_index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">))</span>
    <span class="n">energies</span> <span class="o">=</span> <span class="n">energy</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

    <span class="n">atom_densities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_atoms</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
    <span class="p">):</span>
        <span class="n">atom_densities_up</span> <span class="o">=</span> <span class="n">atom_densities</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">atom_densities_down</span> <span class="o">=</span> <span class="n">atom_densities</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">densities_up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">atom_densities_up</span><span class="p">[:,</span> <span class="p">[</span><span class="n">group</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">densities_down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">atom_densities_down</span><span class="p">[:,</span> <span class="p">[</span><span class="n">group</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">densities</span> <span class="o">=</span> <span class="p">(</span><span class="n">densities_up</span> <span class="o">-</span> <span class="n">densities_down</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">densities_up</span> <span class="o">+</span> <span class="n">densities_down</span>
        <span class="p">)</span>
        <span class="n">densities</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">densities</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1e-9</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">atom_densities</span> <span class="o">=</span> <span class="n">atom_densities</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">densities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">atom_densities</span><span class="p">[:,</span> <span class="p">[</span><span class="n">group</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="n">densities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">lrange</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">atom_index</span> <span class="o">=</span> <span class="n">atom_index</span><span class="p">[</span><span class="n">lrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">lrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">densities</span> <span class="o">=</span> <span class="n">densities</span><span class="p">[:,</span> <span class="n">lrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">lrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">sigma_energy</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">densities</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_smear</span><span class="p">(</span>
                <span class="n">densities</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span>
                <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_energy</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="n">sigma_layers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">densities</span> <span class="o">=</span> <span class="n">gaussian_filter</span><span class="p">(</span><span class="n">densities</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_layers</span><span class="p">)</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">interp2d</span><span class="p">(</span><span class="n">atom_index</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">densities</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;cubic&quot;</span><span class="p">)</span>
    <span class="n">atom_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">atom_index</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">atom_index</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">densities</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">atom_index</span><span class="p">,</span> <span class="n">energies</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">neg_zero_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">densities</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">pos_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">densities</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">densities</span><span class="p">[</span><span class="n">pos_loc</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">min_val</span> <span class="o">&lt;</span> <span class="n">min_cutoff</span><span class="p">:</span>
                <span class="n">min_val</span> <span class="o">=</span> <span class="n">min_cutoff</span>
                <span class="n">too_small_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">densities</span> <span class="o">&lt;</span> <span class="n">min_cutoff</span><span class="p">)</span>
                <span class="n">densities</span><span class="p">[</span><span class="n">too_small_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_cutoff</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">densities</span><span class="p">[</span><span class="n">neg_zero_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">min_val</span> <span class="o">&lt;</span> <span class="n">min_cutoff</span><span class="p">:</span>
                <span class="n">min_val</span> <span class="o">=</span> <span class="n">min_cutoff</span>

        <span class="k">if</span> <span class="n">max_cutoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_val</span> <span class="o">=</span> <span class="n">max_cutoff</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span>

        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">min_val</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">max_val</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">set_bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">norm_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">densities</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">densities</span><span class="p">)])</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">norm_val</span> <span class="o">=</span> <span class="n">set_bounds</span>

            <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="n">norm_val</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">norm_val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">max_cutoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">max_val</span> <span class="o">=</span> <span class="n">max_cutoff</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">min_cutoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">min_val</span> <span class="o">=</span> <span class="n">min_cutoff</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span>

            <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">min_val</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">max_val</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
        <span class="n">lev_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lev_exp</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">levels</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">levels</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">lev_exp</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">lev_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="mf">0.25</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lev_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="mf">0.5</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">lev_exp</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">interface_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">atom_index</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">interface_layer</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">contour</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
                <span class="n">atom_index</span><span class="p">,</span>
                <span class="n">energies</span><span class="p">,</span>
                <span class="n">densities</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
                <span class="n">atom_index</span><span class="p">,</span>
                <span class="n">energies</span><span class="p">,</span>
                <span class="n">densities</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;gouraud&quot;</span><span class="p">,</span>
                <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                <span class="n">antialiased</span><span class="o">=</span><span class="n">antialiased</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">interface_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">show_interface_line</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">interface_line_color</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="n">interface_line_style</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">interface_line_width</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">contour</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
                <span class="n">energies</span><span class="p">,</span>
                <span class="n">atom_index</span><span class="p">,</span>
                <span class="n">densities</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
                <span class="n">energies</span><span class="p">,</span>
                <span class="n">atom_index</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">densities</span><span class="p">),</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;gouraud&quot;</span><span class="p">,</span>
                <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                <span class="n">antialiased</span><span class="o">=</span><span class="n">antialiased</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">interface_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">show_interface_line</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
                <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">interface_line_color</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="n">interface_line_style</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">interface_line_width</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">cbar_orientation</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">custom_cbar_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Spin Polarization&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="n">min_val</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">vmin</span>
            <span class="n">max_val</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">vmax</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">show_bounds</span><span class="p">:</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s2">&quot;Down&quot;</span><span class="p">,</span> <span class="s2">&quot;Up&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Density of States&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">custom_cbar_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="vaspvis.dos.Dos.plot_ldos" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_ldos</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">layers</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">energyaxis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_layer_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function plots the total density of states</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.pyplot.axis">axis</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to append the tick labels</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>linewidth</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Linewidth of lines</p>
            </div>
          </td>
          <td>
                <code>1.5</code>
          </td>
        </tr>
        <tr>
          <td><code>fill</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wether or not to fill underneath the plot</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the fill</p>
            </div>
          </td>
          <td>
                <code>0.3</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha_line</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the line</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard deviation for gaussian filter</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>energyaxis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines the axis to plot the energy on ('x' or 'y')</p>
            </div>
          </td>
          <td>
                <code>&#39;x&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Color of line</p>
            </div>
          </td>
          <td>
                <code>&#39;black&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>erange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Energy range for the DOS plot ([lower bound, upper bound])</p>
            </div>
          </td>
          <td>
                <code>[-6, 6]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>vaspvis/dos.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_ldos</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">layers</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">custom_layer_inds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the total density of states</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ax (matplotlib.pyplot.axis): Axis to append the tick labels</span>
<span class="sd">        linewidth (float): Linewidth of lines</span>
<span class="sd">        fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">        alpha (float): Alpha value for the fill</span>
<span class="sd">        alpha_line (float): Alpha value for the line</span>
<span class="sd">        sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">        energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">        color (str): Color of line</span>
<span class="sd">        erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#  tdos_array = self._sum_layers(layers=layers)</span>
    <span class="n">tdos_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span>

    <span class="n">tdensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_layers</span><span class="p">(</span>
        <span class="n">layers</span><span class="o">=</span><span class="n">layers</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span> <span class="n">custom_layer_inds</span><span class="o">=</span><span class="n">custom_layer_inds</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combination_method</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_method</span> <span class="o">==</span> <span class="s2">&quot;percentage&quot;</span>
    <span class="p">):</span>
        <span class="n">tdensity</span> <span class="o">=</span> <span class="p">(</span><span class="n">tdensity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">tdensity</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">tdensity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">tdensity</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">tdensity</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tdensity</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1e-9</span>

    <span class="k">if</span> <span class="n">sigma</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">tdensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_smear</span><span class="p">(</span><span class="n">tdensity</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
        <span class="n">tdensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tdensity</span><span class="p">)</span>
        <span class="n">neg_inf_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">tdensity</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
        <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">tdensity</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">neg_inf_loc</span><span class="p">)])</span>
        <span class="n">tdensity</span><span class="p">[</span><span class="n">neg_inf_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_val</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_set_density_lims</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">tdensity</span><span class="o">=</span><span class="n">tdensity</span><span class="p">,</span>
        <span class="n">tenergy</span><span class="o">=</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">spin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="p">,</span>
        <span class="n">log_scale</span><span class="o">=</span><span class="n">log_scale</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">tdensity</span><span class="p">,</span>
            <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span>
                <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">tdensity</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">tdensity</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
                <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">tdensity</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="vaspvis.dos.Dos.plot_orbitals" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_orbitals</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">orbitals</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">energyaxis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function plots the total density of states with the projected
density of states for the projections onto given orbitals</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.pyplot.axis">axis</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to plot on</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>orbitals</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of orbitals to project onto</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fill</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wether or not to fill underneath the plot</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the fill</p>
            </div>
          </td>
          <td>
                <code>0.3</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha_line</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the line</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>linewidth</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Linewidth of lines</p>
            </div>
          </td>
          <td>
                <code>1.5</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard deviation for gaussian filter</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>energyaxis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines the axis to plot the energy on ('x' or 'y')</p>
            </div>
          </td>
          <td>
                <code>&#39;y&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>color_dict</code></td>
          <td>
                <code>dict[str][str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This option allow the colors of each orbital
specified. Should be in the form of:
{'orbital index': <color>, 'orbital index': <color>, ...}</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>legend</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines whether to draw the legend or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>total</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wheth to draw the total density of states or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>erange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Energy range for the DOS plot ([lower bound, upper bound])</p>
            </div>
          </td>
          <td>
                <code>[-6, 6]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>vaspvis/dos.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_orbitals</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">orbitals</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the total density of states with the projected</span>
<span class="sd">    density of states for the projections onto given orbitals</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">        orbitals (list): List of orbitals to project onto</span>
<span class="sd">        fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">        alpha (float): Alpha value for the fill</span>
<span class="sd">        alpha_line (float): Alpha value for the line</span>
<span class="sd">        linewidth (float): Linewidth of lines</span>
<span class="sd">        sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">        energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">        color_dict (dict[str][str]): This option allow the colors of each orbital</span>
<span class="sd">            specified. Should be in the form of:</span>
<span class="sd">            {&#39;orbital index&#39;: &lt;color&gt;, &#39;orbital index&#39;: &lt;color&gt;, ...}</span>
<span class="sd">        legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">        total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">        erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbitals</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

    <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_orbitals</span><span class="p">(</span><span class="n">orbitals</span><span class="o">=</span><span class="n">orbitals</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">orbital_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbitals</span><span class="p">],</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="vaspvis.dos.Dos.plot_plain" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_plain</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">energyaxis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function plots the total density of states</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.pyplot.axis">axis</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to append the tick labels</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>linewidth</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Linewidth of lines</p>
            </div>
          </td>
          <td>
                <code>1.5</code>
          </td>
        </tr>
        <tr>
          <td><code>fill</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wether or not to fill underneath the plot</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the fill</p>
            </div>
          </td>
          <td>
                <code>0.3</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha_line</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the line</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard deviation for gaussian filter</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>energyaxis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines the axis to plot the energy on ('x' or 'y')</p>
            </div>
          </td>
          <td>
                <code>&#39;y&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Color of line</p>
            </div>
          </td>
          <td>
                <code>&#39;black&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>erange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Energy range for the DOS plot ([lower bound, upper bound])</p>
            </div>
          </td>
          <td>
                <code>[-6, 6]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>vaspvis/dos.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_plain</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the total density of states</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ax (matplotlib.pyplot.axis): Axis to append the tick labels</span>
<span class="sd">        linewidth (float): Linewidth of lines</span>
<span class="sd">        fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">        alpha (float): Alpha value for the fill</span>
<span class="sd">        alpha_line (float): Alpha value for the line</span>
<span class="sd">        sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">        energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">        color (str): Color of line</span>
<span class="sd">        erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tdos_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span>
    <span class="n">energy_in_plot_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="p">(</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">erange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">erange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">tdos_array</span> <span class="o">=</span> <span class="n">tdos_array</span><span class="p">[</span><span class="n">energy_in_plot_index</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">sigma</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">tdensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_smear</span><span class="p">(</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tdensity</span> <span class="o">=</span> <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
        <span class="n">tdensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tdensity</span><span class="p">)</span>
        <span class="n">neg_inf_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">tdensity</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
        <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">tdensity</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">neg_inf_loc</span><span class="p">)])</span>
        <span class="n">tdensity</span><span class="p">[</span><span class="n">neg_inf_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_val</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_set_density_lims</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">tdensity</span><span class="o">=</span><span class="n">tdensity</span><span class="p">,</span>
        <span class="n">tenergy</span><span class="o">=</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">spin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="p">,</span>
        <span class="n">log_scale</span><span class="o">=</span><span class="n">log_scale</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">tdensity</span><span class="p">,</span>
            <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span>
                <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">tdensity</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">energyaxis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">tdensity</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
                <span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">tdensity</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="vaspvis.dos.Dos.plot_spd" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_spd</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">orbitals</span><span class="o">=</span><span class="s1">&#39;spd&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">energyaxis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function plots the total density of states with the projected
density of states for the total projections of the s, p, and d orbitals.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.pyplot.axis">axis</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axis to plot on</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>order</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Order to plot the projected bands in. This feature helps to
avoid situations where one projection completely convers the other.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fill</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wether or not to fill underneath the plot</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the fill</p>
            </div>
          </td>
          <td>
                <code>0.3</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha_line</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for the line</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>linewidth</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Linewidth of lines</p>
            </div>
          </td>
          <td>
                <code>1.5</code>
          </td>
        </tr>
        <tr>
          <td><code>sigma</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard deviation for gaussian filter</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>energyaxis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines the axis to plot the energy on ('x' or 'y')</p>
            </div>
          </td>
          <td>
                <code>&#39;y&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>color_dict</code></td>
          <td>
                <code>dict[str][str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This option allow the colors of the s, p, and d
orbitals to be specified. Should be in the form of:
{'s': <s color>, 'p': <p color>, 'd': <d color>}</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>legend</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines whether to draw the legend or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>total</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines wheth to draw the total density of states or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>erange</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Energy range for the DOS plot ([lower bound, upper bound])</p>
            </div>
          </td>
          <td>
                <code>[-6, 6]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>vaspvis/dos.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_spd</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">,</span>
    <span class="n">orbitals</span><span class="o">=</span><span class="s2">&quot;spd&quot;</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">alpha_line</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">energyaxis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">color_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">total</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the total density of states with the projected</span>
<span class="sd">    density of states for the total projections of the s, p, and d orbitals.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ax (matplotlib.pyplot.axis): Axis to plot on</span>
<span class="sd">        order (list): Order to plot the projected bands in. This feature helps to</span>
<span class="sd">            avoid situations where one projection completely convers the other.</span>
<span class="sd">        fill (bool): Determines wether or not to fill underneath the plot</span>
<span class="sd">        alpha (float): Alpha value for the fill</span>
<span class="sd">        alpha_line (float): Alpha value for the line</span>
<span class="sd">        linewidth (float): Linewidth of lines</span>
<span class="sd">        sigma (float): Standard deviation for gaussian filter</span>
<span class="sd">        energyaxis (str): Determines the axis to plot the energy on (&#39;x&#39; or &#39;y&#39;)</span>
<span class="sd">        color_dict (dict[str][str]): This option allow the colors of the s, p, and d</span>
<span class="sd">            orbitals to be specified. Should be in the form of:</span>
<span class="sd">            {&#39;s&#39;: &lt;s color&gt;, &#39;p&#39;: &lt;p color&gt;, &#39;d&#39;: &lt;d color&gt;}</span>
<span class="sd">        legend (bool): Determines whether to draw the legend or not</span>
<span class="sd">        total (bool): Determines wheth to draw the total density of states or not</span>
<span class="sd">        erange (list): Energy range for the DOS plot ([lower bound, upper bound])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">projected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_spd</span><span class="p">(</span><span class="n">spd</span><span class="o">=</span><span class="n">orbitals</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color_dict</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">color_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbitals</span><span class="p">))])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">color_list</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_projected_general</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">energy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tdos_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">projected_data</span><span class="o">=</span><span class="n">projected_data</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
        <span class="n">erange</span><span class="o">=</span><span class="n">erange</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
        <span class="n">alpha_line</span><span class="o">=</span><span class="n">alpha_line</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span>
        <span class="n">energyaxis</span><span class="o">=</span><span class="n">energyaxis</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">orbitals</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.7389ff0e.min.js"></script>
      
    
  </body>
</html>